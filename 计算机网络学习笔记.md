## 计算机网络

### 一、网络分层与数据传输

#### 1、网络模型分层

在互联网上，网络分层模型有3种：TCP/IP四层模型、五层模型、OSI七层模型。

实际上在，在早期的生产环境中用的就是TCP/IP四层模型并且一直沿用至今。ISO 推出的 OSI 的七层模型是后来才提出来的，可能是为了规范化把，但是实际上OSI七层模型并没有如愿的普及开来，生产环境中还是使用的TCP/IP四层模型，所以现在七层模型其实就是用来辅助人们理解网络的分层。

而五层模型是综合了TCP/IP四层模型和OSI七层模型得到的，它的出现也是为了方便人民学习计算机网络原理而采用的，学习用的。

##### TCP/IP 四层模型包括以下四层：

1. 网络接口层（Network Interface Layer）：
   - 负责处理与物理网络的连接，包括物理地址（MAC 地址）的处理、数据的实际传输等。
   - 涵盖了操作系统中的设备驱动程序和网络接口卡（NIC）等硬件相关的部分。
2. 网络层（Internet Layer）：
   - 主要协议是 IP（网际协议）。
   - 负责数据包的路由和寻址，决定数据包从源主机到目标主机的路径。
3. 传输层（Transport Layer）：
   - 主要有 TCP（传输控制协议）和 UDP（用户数据报协议）。
   - TCP 提供可靠的、面向连接的服务，保证数据的顺序、无差错传输。UDP 提供不可靠的、无连接的数据报服务，速度快但可能会有数据丢失或乱序。
4. 应用层（Application Layer）：
   - 包含了各种应用程序使用的协议，如 HTTP（超文本传输协议）、FTP（文件传输协议）、SMTP（简单邮件传输协议）、DNS（域名系统）等。

##### OSI（Open Systems Interconnection，开放系统互连）七层模型包括以下七层：

1. 物理层（Physical Layer）：
   - 定义了物理设备的规格、接口类型、线缆标准、传输速率等。
   - 例如，以太网的线缆类型（如双绞线、光纤）、连接器的规格等都在这一层定义。
2. 数据链路层（Data Link Layer）：
   - 负责将数据帧从一个节点传输到相邻节点。
   - 包括 MAC 地址的使用、数据帧的封装和解封装、差错检测等。
   - 常见的协议有以太网、PPP 等。
3. 网络层（Network Layer）：
   - 负责网络中的路由选择和数据包的转发。
   - 通过 IP 地址进行寻址，选择最佳的路径将数据包从源发送到目的地。
   - 常见的协议是 IP 以及辅助协议如 ICMP、IGMP 等。
4. 传输层（Transport Layer）：
   - 提供端到端的可靠或不可靠的数据传输服务。
   - TCP 提供可靠的、面向连接的传输，保证数据的顺序和完整性。UDP 提供不可靠的、无连接的传输，快速但可能会有数据丢失。
5. 会话层（Session Layer）：
   - 建立、管理和终止应用程序之间的会话。
   - 处理会话的同步、检查点设置等。
6. 表示层（Presentation Layer）：
   - 负责数据的格式转换、加密、压缩等。
   - 确保不同系统之间能够正确理解和处理数据的表示形式。
7. 应用层（Application Layer）：
   - 为用户的应用程序提供网络服务。
   - 常见的应用层协议有 HTTP、FTP、SMTP、POP3 等。

OSI 七层模型是一个理论上的参考模型，有助于理解网络通信的不同层次和功能，但在实际中，TCP/IP 模型更为常用。

#### 2、数据在网络中的传输

##### 2.1、协议数据单元PDU

**协议数据单元PDU是指对等层次之间传递的数据单位。**

- 物理层的PDU是**数据位**(bit)
- 数据链路层的PDU是**数据帧**(frame)
- 网络层的PDU是**数据包**(packet)
- 传输层的PDU是**数据段**(segment)
- 应用层的PDU是**数据**(data)

##### 2.2、数据的封装过程

应用层的数据需要进行层层封装才能在互联网中通过比特流进行传输，到达目的主机后再进行层层的解封装，最后由目的主机的应用读取来源主机应用的数据。

##### 2.3、单播、广播、多播、组播

单播：一对一的通信方式，数据由一台设备发出，最后由一台设备接收，接收方只有1个。

广播：一对所有的通信方式，数据由一台设备发出，网络中的所有设备都会接收到数据，接收方是网络中的所有主机。

多播：一对多的通信方式，数据由一台设备发出，网络中的多个设备会收到数据，接收方是网络中的部分主机。多播可以在2层多播，也就是MAC多播，比如ARP协议；也就可以在3层多播，也就是IP多播。

组播：一种特定多播形式，属于是多播的子集。它将数据包发送到一个组，这个组包含了所有需要接收这个数据包的节点。组播通常在网络层进行，使用IP多播地址来标识目标组。组播的主要应用是在大型网络环境中，如互联网电视(IPTV)和视频会议等。

##### 2.4、冲突域、广播域

冲突域：两个网络设备同时发送数据，如果发生了冲突，则两个设备处于同一个冲突域，反之，则各自处于不同的冲突域。

广播域：一个网络设备发送广播，另一个设备收到了，则两个设备处于同一个广播域，反之，则各自处于不同的 广播域。

在现代网络中，冲突域已经大大减少，这主要是因为现代网络设备（如交换机）的使用。交换机可以在其端口之间建立专用的通信路径，从而使每个端口都成为一个单独的冲突域。这与早期的网络设备（如集线器）不同，集线器会将所有端口放在同一个冲突域中。

此外，现代网络设备通常支持全双工通信，这意味着设备可以同时发送和接收数据，从而进一步减少冲突的可能性。全双工通信不会产生冲突，因为发送和接收是在不同的信道上进行的。

##### 2.5、单工、半双工、全双工

单工通信：只有一个方向的通信

半双工通信：通信双方都可以发送和接收信息，但不能同时发送，也不能同时接收。可以理解为同一时时只有一个设备在发送数据，其它设备只能监听

全双工通信：通信双方可以同时发送和同时接收

### 二、TCP协议

TCP（Transmission Control Protocol，传输控制协议）是一种面向连接的、可靠的传输层协议。

以下是 TCP 协议的一些关键特点和工作原理：

1. 面向连接：在数据传输之前，通信双方需要通过 “三次握手” 建立连接。
2. 可靠传输：
   - 采用序列号和确认号机制来确保数据的按序到达和无丢失。
   - 发送方发送数据后，接收方会返回确认，如果发送方在一定时间内没有收到确认，就会重传数据。
   - 还具有流量控制和拥塞控制机制，以避免网络拥塞和数据丢失。
3. 数据分段：将数据分割成适当大小的段进行传输。
4. 端口号：通过源端口号和目的端口号来标识不同的应用程序或进程。

TCP 协议常用于对数据传输可靠性要求较高的应用，如文件传输、电子邮件、网页浏览等。

TCP 传输数据的过程主要包括建立连接、数据传输和断开连接三个阶段，具体方式如下：

**建立连接（三次握手）**：

1. 客户端向服务器发送一个带有 SYN（同步）标志的 TCP 段，选择一个初始序列号（ISN），并告诉服务器自己想要建立连接。
2. 服务器收到客户端的 SYN 段后，向客户端发送一个带有 SYN 和 ACK（确认）标志的 TCP 段，确认收到客户端的请求，并选择自己的初始序列号，同时对客户端的序列号进行确认。
3. 客户端收到服务器的 SYN+ACK 段后，向服务器发送一个带有 ACK 标志的 TCP 段，确认收到服务器的响应，至此连接建立完成。

**数据传输**：

1. 建立连接后，双方就可以进行数据传输。发送方将数据分割成适当大小的段，并为每个段分配一个序列号。
2. 接收方收到数据段后，会发送 ACK 确认给发送方，表示已经成功接收。如果接收方发现某个数据段丢失或损坏，会请求发送方重传。
3. 发送方会根据接收方返回的 ACK 信息调整发送窗口的大小，实现流量控制，以避免接收方缓冲区溢出。

**断开连接（四次挥手）**：

1. 客户端向服务器发送一个带有 FIN（结束）标志的 TCP 段，表示自己没有数据要发送了，想要关闭连接。
2. 服务器收到客户端的 FIN 段后，返回一个 ACK 确认，表示已经收到客户端的关闭请求。
3. 服务器发送完自己的数据后，也向客户端发送一个带有 FIN 标志的 TCP 段，表示自己也没有数据要发送了。
4. 客户端收到服务器的 FIN 段后，返回一个 ACK 确认，至此连接完全关闭。

在整个传输过程中，TCP 还通过拥塞控制机制来适应网络的拥塞情况，调整发送数据的速率，以保证网络的稳定性和高效性。

### 三、UDP协议

UDP（User Datagram Protocol，用户数据报协议）是一种无连接的、不可靠的传输层协议。

以下是 UDP 协议的一些特点和工作方式：

特点：

1. 无连接：在发送数据之前，不需要建立连接，直接将数据封装成 UDP 数据报发送出去。
2. 不可靠：不保证数据的可靠交付，可能会出现数据丢失、重复、乱序等情况。
3. 快速高效：由于没有连接建立和维护的开销，以及较少的协议机制，UDP 具有较低的延迟和较高的传输效率。

工作方式：

1. 应用程序将数据交给 UDP 协议，UDP 为数据添加首部信息，形成 UDP 数据报。
2. UDP 直接将数据报发送到网络中，不进行差错检查和流量控制。
3. 接收方的 UDP 接收到数据报后，去除首部，将数据交给应用程序，如果数据报在传输过程中出现错误，UDP 不做处理。

UDP 常用于对实时性要求较高、能容忍一定数据丢失的应用，比如视频直播、实时游戏、语音通话等。

### 四、ARP协议

ARP（Address Resolution Protocol，地址解析协议）用于将 IP 地址转换为对应的 MAC 地址。

在以太网中，数据帧的传输是基于 MAC 地址的，但通常我们只知道目标设备的 IP 地址。ARP 协议的作用就是在这种情况下，通过广播询问的方式获取目标设备的 MAC 地址。

工作过程如下：

1. 当一台主机想要向另一台主机发送数据时，它首先查看自己的 ARP 缓存表，看是否有目标 IP 地址对应的 MAC 地址。
2. 如果没有，它会发送一个 ARP 请求广播包，请求目标 IP 地址对应的 MAC 地址。
3. 网络中的其他主机收到这个广播包后，只有目标主机会响应，将自己的 MAC 地址回复给请求主机。
4. 请求主机收到回复后，将目标 IP 地址和 MAC 地址的对应关系存入自己的 ARP 缓存表，以便后续使用。

ARP 协议在局域网中起着重要的作用，使得网络通信能够在基于 MAC 地址的硬件层面上正常进行。

### 五、HTTP和HTTPS协议

HTTP（HyperText Transfer Protocol，超文本传输协议）和 HTTPS（HyperText Transfer Protocol Secure，安全超文本传输协议）是用于在网络上传输数据的协议，主要用于客户端（如浏览器）和服务器之间的通信。

#### HTTP 协议：

- 工作在应用层，是一种无状态、基于文本的协议。
- 以明文方式传输数据，不提供数据加密和身份验证机制。
- 通信过程简单，客户端发送请求到服务器，服务器返回相应的响应。

**工作流程**：

1. 客户端（如浏览器）与服务器建立 TCP 连接。
2. 客户端向服务器发送一个 HTTP 请求，请求包含方法（如 GET、POST、PUT 等）、请求的 URL、HTTP 版本、头部信息（如用户代理、接受的内容类型等）和可能的请求体（如果有）。
3. 服务器接收到请求后，根据请求的 URL 和方法进行处理，并生成相应的 HTTP 响应。响应包含状态码（如 200 表示成功、404 表示未找到等）、响应头部和响应体（包含请求的数据）。
4. 客户端接收服务器的响应，并根据响应的内容进行相应的处理，如显示网页、执行脚本等。
5. TCP 连接关闭，除非是持续连接（Keep-Alive）。

#### HTTPS 协议：

- 是 HTTP 协议的安全版本。
- 在 HTTP 的基础上增加了 SSL（Secure Sockets Layer，安全套接层）或 TLS（Transport Layer Security，传输层安全）协议来实现数据加密、身份验证和数据完整性保护。
- 客户端和服务器在建立连接时，会进行一系列的加密握手过程，协商加密算法和密钥等信息。
- 数据在传输过程中是加密的，提高了通信的安全性。

**工作流程（加密握手过程）**：

1. 客户端向服务器发送请求，请求中包含支持的 SSL/TLS 版本和加密套件列表。
2. 服务器选择一个双方都支持的 SSL/TLS 版本和加密套件，并向客户端发送其数字证书，包含服务器的公钥等信息。
3. 客户端验证服务器证书的合法性（如验证证书是否由受信任的 CA 颁发、证书是否过期等）。如果验证通过，客户端生成一个随机的对称密钥，并使用服务器的公钥进行加密，然后发送给服务器。
4. 服务器使用自己的私钥解密获取对称密钥。
5. 此后，双方使用这个对称密钥进行加密通信，传输应用数据。

**优势**：

1. 保护用户隐私：防止敏感信息（如登录凭据、信用卡信息等）被窃取。
2. 增强信任：用户更信任使用 HTTPS 的网站，有助于提高业务的可信度。
3. 符合法规：某些行业和地区的法规要求使用加密来保护用户数据。

**应用场景**：

1. 涉及用户登录、支付等敏感操作的网站。
2. 电子商务平台。
3. 金融服务网站。

### 六、DNS域名解析系统

DNS（Domain Name System，域名系统）是互联网的一项服务，它的主要作用是将易于人类理解的域名（如 [www.example.com](https://www.example.com/)）转换为计算机用于网络通信的 IP 地址（如 192.168.0.1）。

其工作原理如下：

1. 当用户在浏览器中输入一个域名时，计算机首先会查询本地的 DNS 缓存，看是否有该域名对应的 IP 地址记录。
2. 如果本地缓存中没有找到，计算机会向本地网络配置中指定的 DNS 服务器发送查询请求。
3. DNS 服务器收到请求后，如果自己的缓存中有对应的记录，就直接返回给客户端。
4. 如果 DNS 服务器的缓存中没有，它会从根域名服务器开始，逐步递归或迭代查询，直到找到负责该域名的权威 DNS 服务器，并获取到对应的 IP 地址。
5. DNS 服务器将获取到的 IP 地址返回给客户端，客户端就可以使用该 IP 地址与目标服务器建立连接进行通信。

DNS 系统采用了分布式的数据库架构，由多个层次的 DNS 服务器共同协作，以确保域名解析的高效和准确。

### 七、交换机

dis mac-address查看有哪些物理机连接